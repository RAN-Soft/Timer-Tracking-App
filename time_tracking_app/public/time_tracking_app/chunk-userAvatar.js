import{d as E,r as w,c as y,a6 as C,a7 as U,o as L,i as B,G as S,k as d,j as _,u as r,a8 as f,w as i,E as p,n as v,x as h,X as g,_ as k,a9 as x}from"./app.js";const I={class:"sync-status"},F=E({__name:"SyncStatusBar",setup(e){const n=w(navigator.onLine),o=w(0),a=y(()=>{o.value;const m=C().length,u=U().length;return m+u});function t(){o.value++}function l(){n.value=!0}function c(){n.value=!1}function s(){t()}return L(()=>{t(),window.addEventListener("online",l),window.addEventListener("offline",c),window.addEventListener("tta-sync-updated",s)}),B(()=>{window.removeEventListener("online",l),window.removeEventListener("offline",c),window.removeEventListener("tta-sync-updated",s)}),(m,u)=>(g(),S("div",I,[d(r(f),{color:n.value?"success":"warning"},{default:i(()=>[d(r(p),null,{default:i(()=>[v(h(n.value?"Online":"Offline"),1)]),_:1})]),_:1},8,["color"]),a.value>0?(g(),_(r(f),{key:0,color:"medium"},{default:i(()=>[d(r(p),null,{default:i(()=>[v(h(a.value)+" EintrÃ¤ge zum Synchronisieren ",1)]),_:1})]),_:1})):(g(),_(r(f),{key:1,color:"light"},{default:i(()=>[d(r(p),null,{default:i(()=>[...u[0]||(u[0]=[v("Alles synchron",-1)])]),_:1})]),_:1}))]))}}),N=k(F,[["__scopeId","data-v-1950bd1b"]]);async function b(){try{await fetch("/api/method/logout",{method:"GET",credentials:"include"})}catch(e){console.error("Logout error",e)}window.location.href="/login?redirect-to=/time-tracking"}function O(e){if(!e)return"U";const n=e.includes("@")?e.split("@")[0]:e;if(n.includes(".")){const o=n.split("."),a=o[0]?.[0]??"",t=o[1]?.[0]??"";return(a+t).toUpperCase()||n.slice(0,2).toUpperCase()}return n.slice(0,2).toUpperCase()}function P(){const e=w("U"),n=y(()=>{const t=["#4F46E5","#EF4444","#10B981","#3B82F6","#F59E0B","#6366F1"],l=e.value||"U";let c=0;for(let s=0;s<l.length;s++)c+=l.charCodeAt(s);return t[c%t.length]});async function o(){try{const t=await x();e.value=O(t)}catch(t){console.warn("Could not load current user for avatar",t)}}async function a(){await b()}return{userInitials:e,avatarColor:n,loadUserInitials:o,logout:a}}export{N as S,b as l,P as u};
