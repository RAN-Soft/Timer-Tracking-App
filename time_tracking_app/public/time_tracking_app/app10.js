import{d as E,r as w,c as y,a0 as U,a1 as C,o as L,h as B,F as S,j as d,i as h,u as r,a2 as f,w as i,D as p,m as v,v as _,U as g,a3 as k,a4 as F}from"./app.js";const I={class:"sync-status"},x=E({__name:"SyncStatusBar",setup(e){const n=w(navigator.onLine),o=w(0),a=y(()=>{o.value;const m=U().length,u=C().length;return m+u});function t(){o.value++}function l(){n.value=!0}function c(){n.value=!1}function s(){t()}return L(()=>{t(),window.addEventListener("online",l),window.addEventListener("offline",c),window.addEventListener("tta-sync-updated",s)}),B(()=>{window.removeEventListener("online",l),window.removeEventListener("offline",c),window.removeEventListener("tta-sync-updated",s)}),(m,u)=>(g(),S("div",I,[d(r(f),{color:n.value?"success":"warning"},{default:i(()=>[d(r(p),null,{default:i(()=>[v(_(n.value?"Online":"Offline"),1)]),_:1})]),_:1},8,["color"]),a.value>0?(g(),h(r(f),{key:0,color:"medium"},{default:i(()=>[d(r(p),null,{default:i(()=>[v(_(a.value)+" EintrÃ¤ge zum Synchronisieren ",1)]),_:1})]),_:1})):(g(),h(r(f),{key:1,color:"light"},{default:i(()=>[d(r(p),null,{default:i(()=>[...u[0]||(u[0]=[v("Alles synchron",-1)])]),_:1})]),_:1}))]))}}),N=k(x,[["__scopeId","data-v-1950bd1b"]]);async function b(){try{await fetch("/api/method/logout",{method:"GET",credentials:"include"})}catch(e){console.error("Logout error",e)}window.location.href="/login?redirect-to=/tracker"}function O(e){if(!e)return"U";const n=e.includes("@")?e.split("@")[0]:e;if(n.includes(".")){const o=n.split("."),a=o[0]?.[0]??"",t=o[1]?.[0]??"";return(a+t).toUpperCase()||n.slice(0,2).toUpperCase()}return n.slice(0,2).toUpperCase()}function P(){const e=w("U"),n=y(()=>{const t=["#4F46E5","#EF4444","#10B981","#3B82F6","#F59E0B","#6366F1"],l=e.value||"U";let c=0;for(let s=0;s<l.length;s++)c+=l.charCodeAt(s);return t[c%t.length]});async function o(){try{const t=await F();e.value=O(t)}catch(t){console.warn("Could not load current user for avatar",t)}}async function a(){await b()}return{userInitials:e,avatarColor:n,loadUserInitials:o,logout:a}}export{N as S,P as u};
